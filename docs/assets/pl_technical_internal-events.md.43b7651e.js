import{_ as s,c as a,o as n,d as o}from"./app.6c2f0944.js";const l="/SessionAPI/assets/componentInit.5f5795c0.gif",p="/SessionAPI/assets/playerInit.ac4c21ff.gif",z=JSON.parse('{"title":"Zdarzenie wewn\u0119trzne","description":"","frontmatter":{},"headers":[{"level":2,"title":"Uruchomienie komponentu","slug":"uruchomienie-komponentu","link":"#uruchomienie-komponentu","children":[]},{"level":2,"title":"Zako\u0144czenie komponentu","slug":"zakonczenie-komponentu","link":"#zakonczenie-komponentu","children":[]},{"level":2,"title":"Inicjacja gracza","slug":"inicjacja-gracza","link":"#inicjacja-gracza","children":[]},{"level":2,"title":"Deinicjacja gracza","slug":"deinicjacja-gracza","link":"#deinicjacja-gracza","children":[]},{"level":2,"title":"Pro\u015Bba o do\u0142\u0105czenie gracza","slug":"prosba-o-do\u0142aczenie-gracza","link":"#prosba-o-do\u0142aczenie-gracza","children":[]},{"level":2,"title":"Odzyskiwanie komponentu (Recovery)","slug":"odzyskiwanie-komponentu-recovery","link":"#odzyskiwanie-komponentu-recovery","children":[]},{"level":2,"title":"Odzyskiwanie stanu gracza (Recovery)","slug":"odzyskiwanie-stanu-gracza-recovery","link":"#odzyskiwanie-stanu-gracza-recovery","children":[]}],"relativePath":"pl/technical/internal-events.md"}'),e={name:"pl/technical/internal-events.md"},t=o('<h1 id="zdarzenie-wewnetrzne" tabindex="-1">Zdarzenie wewn\u0119trzne <a class="header-anchor" href="#zdarzenie-wewnetrzne" aria-hidden="true">#</a></h1><p>Ka\u017Cdy komponent posiada wbudowane zdarzenia wewn\u0119trzne, kt\xF3re odpowiadaj\u0105 za r\xF3\u017Cne etapy jego cyklu \u017Cycia oraz interakcj\u0119 z graczami.</p><p>Rozr\xF3\u017Cniamy kolejno\u015B\u0107 wykonywania zdarze\u0144 <a href="/SessionAPI/pl/technical/sequence-event-execution.html"><strong>lokaln\u0105</strong></a> <em>(wewn\u0105trz komponentu)</em> oraz <a href="/SessionAPI/pl/technical/nested-trees.html"><strong>globaln\u0105</strong></a> <em>(w ca\u0142ej strukturze drzewa)</em>.</p><h2 id="uruchomienie-komponentu" tabindex="-1">Uruchomienie komponentu <a class="header-anchor" href="#uruchomienie-komponentu" aria-hidden="true">#</a></h2><p>Wywo\u0142ywane automatycznie podczas uruchamiania komponentu. S\u0142u\u017Cy do jego inicjalizacji (np. tworzenie zasob\xF3w, uruchamianie w\u0105tk\xF3w, inicjalizacja stanu).</p><p><img src="'+l+`" alt="Uruchomienie komponentu"></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// MyComponent.java</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onComponentInit</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ComponentConstructor</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    super</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onComponentInit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Komponent zosta\u0142 uruchomiony</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Uruchamia cykliczne zadanie co 10 tick\xF3w, kt\xF3re rozdaje graczom przedmioty</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">runTaskTimer</span><span style="color:#89DDFF;">(this</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">giveItems</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> Time</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> Time</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Inicjalizacja generatora przedmiot\xF3w</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> board </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">board</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">board </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> generatorTag </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> board</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tags</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">generator</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> location </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> generatorTag</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">firstCentredXZ</span><span style="color:#89DDFF;">();</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// Pobranie pozycji generatora</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> label </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Component</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">text</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\xA7a\xA7lGENERATOR</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// Etykieta wy\u015Bwietlana nad generatorem</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> displayMaterial </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">EMERALD_BLOCK</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// Blok reprezentuj\u0105cy generator</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> itemMaterial </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">EMERALD</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// Przedmiot generowany przez generator</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> interval </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Time</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">);</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// Interwa\u0142 generowania przedmiot\xF3w (w tickach)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// Tworzenie i uruchamianie generatora przedmiot\xF3w</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> generator </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ItemGenerator</span><span style="color:#89DDFF;">(this,</span><span style="color:#A6ACCD;"> label</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> location</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> displayMaterial</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> itemMaterial</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> interval</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        generator</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">start</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">giveItems</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">players</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">forEach</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">player </span><span style="color:#C792EA;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> inventory </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> player</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getInventory</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> item </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ItemStack</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DIAMOND</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        inventory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addItem</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">item</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">});</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="zakonczenie-komponentu" tabindex="-1">Zako\u0144czenie komponentu <a class="header-anchor" href="#zakonczenie-komponentu" aria-hidden="true">#</a></h2><p>Wywo\u0142ywane automatycznie podczas wy\u0142\u0105czania komponentu. S\u0142u\u017Cy do zwalniania zasob\xF3w i usuwania element\xF3w utworzonych przez komponent.</p><div class="tip custom-block"><p class="custom-block-title">Automatycznie zwalniane zasoby:</p><ul><li>zadania i w\u0105tki</li><li>podrz\u0119dne komponenty</li><li>listenery Bukkit</li></ul></div><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// MyComponent.java</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onComponentDestroy</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ComponentDestructor</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    super</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onComponentInit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Komponent zosta\u0142 wy\u0142\u0105czony</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="inicjacja-gracza" tabindex="-1">Inicjacja gracza <a class="header-anchor" href="#inicjacja-gracza" aria-hidden="true">#</a></h2><p>S\u0142u\u017Cy do przypisywania graczowi w\u0142a\u015Bciwo\u015Bci lub stanu, wymaganych przez komponent.</p><div class="tip custom-block"><p class="custom-block-title">Uruchamiane, gdy:</p><ul><li>gracz do\u0142\u0105cza do sesji</li><li>komponent jest uruchamiany, a gracze byli ju\u017C w sesji</li></ul></div><p><img src="`+p+`" alt="Inicjacja gracza"></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// MyComponent.java</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onPlayerInit</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">PlayerConstructor</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    super</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onPlayerInit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Inicjalizacja gracza</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> player </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">player</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> inventory </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> player</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getInventory</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Ustawienie zbroi diamentowej</span></span>
<span class="line"><span style="color:#A6ACCD;">    inventory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHelmet</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ItemStack</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DIAMOND_HELMET</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    inventory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setChestplate</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ItemStack</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DIAMOND_CHESTPLATE</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    inventory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setLeggings</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ItemStack</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DIAMOND_LEGGINGS</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    inventory</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setBoots</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ItemStack</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DIAMOND_BOOTS</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Dodanie przedmiot\xF3w do ekwipunku</span></span>
<span class="line"><span style="color:#A6ACCD;">    List</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">            ItemStack</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">DIAMOND_SWORD</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">            ItemStack</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">GOLDEN_APPLE</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">16</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">            ItemStack</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">of</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Material</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">PUMPKIN_PIE</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">32</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">).</span><span style="color:#82AAFF;">forEach</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">inventory</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">addItem</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Nadanie efektu pr\u0119dko\u015Bci na sta\u0142e</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> speedEffect </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">PotionEffect</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">PotionEffectType</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">SPEED</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> PotionEffect</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">INFINITE_DURATION</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    player</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addPotionEffect</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">speedEffect</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Wys\u0142anie wiadomo\u015Bci powitalnej</span></span>
<span class="line"><span style="color:#A6ACCD;">    player</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendMessage</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\xA73Hello, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> player</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getName</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">!</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="deinicjacja-gracza" tabindex="-1">Deinicjacja gracza <a class="header-anchor" href="#deinicjacja-gracza" aria-hidden="true">#</a></h2><p>S\u0142u\u017Cy do usuwania w\u0142a\u015Bciwo\u015Bci lub stanu gracza przypisanego przez komponent.</p><div class="tip custom-block"><p class="custom-block-title">Uruchamiane, gdy:</p><ul><li>gracz opuszcza sesj\u0119</li><li>komponent jest wy\u0142\u0105czany \u2013 usuwa stan przypisany do graczy</li><li>sesja jest zamykana</li></ul></div><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// MyComponent.java</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onPlayerDestroy</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">PlayerDestructor</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  super</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onComponentInit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Deinicjalizacja gracza</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> player </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">player</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    player</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sendMessage</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\xA7cBye, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> player</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getName</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">!</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="prosba-o-do\u0142aczenie-gracza" tabindex="-1">Pro\u015Bba o do\u0142\u0105czenie gracza <a class="header-anchor" href="#prosba-o-do\u0142aczenie-gracza" aria-hidden="true">#</a></h2><p>Pozwala okre\u015Bli\u0107, czy gracz mo\u017Ce do\u0142\u0105czy\u0107 do sesji. Wywo\u0142ywane przy pr\xF3bie do\u0142\u0105czenia.</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// MyComponent.java</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onPlayerJoinRequest</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">PlayerJoinRequest</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  super</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onComponentInit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// Decyzja, czy gracz mo\u017Ce do\u0142\u0105czy\u0107</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> newPlayerCount </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">players</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">size</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">newPlayerCount </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> MY_PLAYER_LIMIT</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> reason </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Reason</span><span style="color:#89DDFF;">(this,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Nie mo\u017Cesz do\u0142\u0105czy\u0107, poniewa\u017C sesja jest ju\u017C pe\u0142na!</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setCanceled</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">reason</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="odzyskiwanie-komponentu-recovery" tabindex="-1">Odzyskiwanie komponentu (Recovery) <a class="header-anchor" href="#odzyskiwanie-komponentu-recovery" aria-hidden="true">#</a></h2><p>Wbudowany mechanizm odzyskiwania pozwala zachowa\u0107 sp\xF3jno\u015B\u0107 stanu nawet w przypadku awarii serwera. Mo\u017Cna przypisa\u0107 zadania, kt\xF3re wykonaj\u0105 si\u0119 automatycznie po restarcie, je\u015Bli komponent nie zosta\u0142 poprawnie wy\u0142\u0105czony.</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// MyComponent.java</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onComponentRecovery</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">ComponentRecovery</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register</span><span style="color:#89DDFF;">(this,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;">// Wykonywane tylko w przypadku awarii</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">});</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">Istotne</p><p>Mechanizm dzia\u0142a na zasadzie serializacji Javy. Przypisuj tylko obiekty, kt\xF3re mo\u017Cna serializowa\u0107.</p></div><h2 id="odzyskiwanie-stanu-gracza-recovery" tabindex="-1">Odzyskiwanie stanu gracza (Recovery) <a class="header-anchor" href="#odzyskiwanie-stanu-gracza-recovery" aria-hidden="true">#</a></h2><p>System odzyskiwania graczy pozwala zachowa\u0107 ich stan po awarii serwera. Mo\u017Cna przypisa\u0107 zadania, kt\xF3re zostan\u0105 wykonane automatycznie, gdy gracz ponownie do\u0142\u0105czy do serwera, je\u015Bli komponent nie usun\u0105\u0142 poprawnie jego stanu.</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// MyComponent.java - przyk\u0142ad awaryjnego usuwania efekt\xF3w gracza</span></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onPlayerRecovery</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">PlayerRecovery</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> owner </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">owner</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Konwersja nieserializowalnych obiekt\xF3w do serializowanych</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> potionTypes </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> owner</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getActivePotionEffects</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stream</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">PotionEffect</span><span style="color:#89DDFF;">::</span><span style="color:#A6ACCD;">getType</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">collect</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Collectors</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toSet</span><span style="color:#89DDFF;">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// Argument &#39;player&#39; nie jest serializowalny, ale zostanie dostarczony przez framework</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// U\u017Cywamy owner(), aby pobra\u0107 dane gracza \u2013 &#39;player&#39; to ten sam gracz w momencie odzyskiwania</span></span>
<span class="line"><span style="color:#A6ACCD;">    event</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register</span><span style="color:#89DDFF;">(this,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">player</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> type </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> potionTypes</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            player</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">removePotionEffect</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">});</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">Istotne</p><p>Mechanizm dzia\u0142a na zasadzie serializacji Javy. Przypisuj tylko obiekty, kt\xF3re mo\u017Cna serializowa\u0107.</p></div>`,31),c=[t];function r(y,D,F,A,i,C){return n(),a("div",null,c)}const u=s(e,[["render",r]]);export{z as __pageData,u as default};
